(()=>{var s=chrome;var W="https://api.nopecha.com";var o="https://www.nopecha.com",y="https://developers.nopecha.com",j="https://nopecha.com/api-reference/",Y={doc:{url:y,automation:{url:`${y}/guides/extension_advanced/#automation-build`}},ref:{url:j},api:{base:W,recognition:"/v1/recognition",status:"/v1/status"},www:{url:o,annoucement:{url:`${o}/json/announcement.json`},demo:{url:`${o}/captcha`,hcaptcha:{url:`${o}/captcha/hcaptcha`},recaptcha:{url:`${o}/captcha/recaptcha`},funcaptcha:{url:`${o}/captcha/funcaptcha`},awscaptcha:{url:`${o}/captcha/awscaptcha`},textcaptcha:{url:`${o}/captcha/textcaptcha`},turnstile:{url:`${o}/captcha/turnstile`},perimeterx:{url:`${o}/captcha/perimeterx`},geetest:{url:`${o}/captcha/geetest`},lemincaptcha:{url:`${o}/captcha/lemincaptcha`}},manage:{url:`${o}/manage`},pricing:{url:`${o}/pricing`},setup:{url:`${o}/setup`}},discord:{url:`${o}/discord`},github:{url:`${o}/github`,release:{url:`${o}/github/release`}}};function S(e){let t=("4bba7932fc09d4cce09e1aba0037cb66b9c0d39d70f4cb482262ba1f523717a7"+e).split("").map(n=>n.charCodeAt(0));return x(t)}var _=new Uint32Array(256);for(let e=256;e--;){let t=e;for(let n=8;n--;)t=t&1?3988292384^t>>>1:t>>>1;_[e]=t}function x(e){let t=-1;for(let n of e)t=t>>>8^_[t&255^n];return(t^-1)>>>0}async function a(e,t){let n=""+[+new Date,performance.now(),Math.random()],[c,u]=await new Promise(g=>{s.runtime.sendMessage([n,e,...t],p=>{g(p)})});if(c===S(n))return u}function M(){let e;return t=>e||(e=t().finally(()=>e=void 0),e)}var i,F=M();function C(){return F(async()=>(i||(i=await a("settings::get",[])),i))}function q(e){i&&(i={...i,...e},B(i))}function f(){return i}function r(e){return new Promise(t=>setTimeout(t,e))}var k=[];function h(e,t){e.timedout=!1,k.push(e);let n,c=setInterval(async()=>{await A(e,f())||(clearTimeout(n),clearInterval(c))},400);t&&(n=setTimeout(()=>clearInterval(c),t),e.timedout=!0)}async function A(e,t){if(e.timedout)return!1;let n=e.condition(t);if(n===e.running())return!1;if(!n&&e.running())return e.quit(),!1;if(n&&!e.running()){for(;!e.ready();)await r(200);return e.start(),!1}}function B(e){k.forEach(t=>A(t,e))}function R(){s.runtime.connect({name:"stream"}).onMessage.addListener(t=>{t.event==="settingsUpdate"&&q(t.settings)})}function b(e){if(document.readyState!=="loading")setTimeout(e,0);else{let t;t=()=>{removeEventListener("DOMContentLoaded",t),e()},addEventListener("DOMContentLoaded",t)}}var K,w=!1;function $(){return!!(document.querySelector("#captcha-container")&&document.querySelector("#amzn-captcha-verify-button"))}function H(){w=!0,G()}function P(){K.disconnect(),w=!1}function T(){return w}async function G(){await r(400),document.querySelector("#amzn-captcha-verify-button")?.click()}function E(){if(document.querySelector('script[src*="awswaf"]')||L(document))return!0;for(let e of document.querySelectorAll("awswaf-captcha")){let t=e.shadowRoot;if(L(t))return!0}return!1}function L(e){let t=e.querySelector("#amzn-captcha-verify-button, #amzn-btn-verify-internal");return!!(e.querySelector("#captcha-container, .amzn-captcha-modal")||t)}async function D(e,t){let n={v:s.runtime.getManifest().version,key:J(e)};return n.url=await a("tab::getURL",[]),n}function J(e){return!e.keys||!e.keys.length?e.key:e.keys[Math.floor(Math.random()*e.keys.length)]}var d,v=!1;function z(){if(N(document))return!0;for(let e of document.querySelectorAll("awswaf-captcha")){let t=e.shadowRoot;if(N(t))return!0}return!1}function U(){v=!0;let e=t=>{t.filter(n=>n.type==="childList"&&n.addedNodes.length).map(n=>[...n.addedNodes]).flat().filter(n=>n.nodeName==="AWSWAF-CAPTCHA").map(n=>n.shadowRoot).forEach(n=>{d.observe(n,{subtree:!0,childList:!0}),l(n)}),[3,4,5].includes(t.length)?l(t[0].target.parentElement):t.length===1&&t[0].addedNodes.length&&t[0].addedNodes[0].id==="root"&&l(t[0].addedNodes[0])};d=new MutationObserver(e),d.observe(document,{subtree:!0,childList:!0}),l(document),document.querySelectorAll("awswaf-captcha").forEach(t=>{let n=t.shadowRoot;d.observe(n,{subtree:!0,childList:!0}),l(n)})}function I(){d.disconnect(),v=!1}function Q(){return v}function l(e){let t=e.querySelector("#amzn-btn-audio, #amzn-btn-audio-internal");e.querySelector("audio")||t?.click(),e.querySelector("audio")&&V(e),(e.querySelector("audio")||t)&&a("tab::registerDetectedCaptcha",["awscaptcha"])}function N(e){let t=e.querySelector("#amzn-btn-audio, #amzn-btn-audio-internal");return!!(e.querySelector("audio")||t)}var O;async function V(e){let t=e.querySelector("audio").src.replace("data:audio/aac;base64,","");if(t===O||(O=t,!t))return;let n=f(),c=new Date().valueOf(),u=await a("api::recognition",[{type:"awscaptcha",audio_data:[t],...await D(n)}]);if(!u||"error"in u)return;let g=new Date().valueOf();if(n.awscaptcha_solve_delay){let m=n.awscaptcha_solve_delay_time-g+c;m>0&&await r(m)}let p=u.data[0];p?(e.querySelector("input").value=p,await r(200),e.querySelector("#amzn-btn-verify-internal")?.click()):e.querySelector("#amzn-btn-refresh-internal")?.click()}async function X(){let e=!1;for(let n=0;n<3;n++)if(await r(1e3),E()){e=!0;break}if(!e)return;R(),await C(),await a("tab::registerDetectedCaptcha",["awscaptcha"]);let t=location.hostname;h({name:"awscaptcha/auto-open",condition:n=>n.enabled&&n.awscaptcha_auto_open&&!n.disabled_hosts.includes(t),ready:$,start:H,quit:P,running:T}),h({name:"awscaptcha/auto-solve",condition:n=>n.enabled&&n.awscaptcha_auto_solve&&!n.disabled_hosts.includes(t),ready:z,start:U,quit:I,running:Q})}b(X);})();
